# Задание 1. Резервное копирование
# Кейс
      Финансовая компания решила увеличить надёжность работы баз данных и их резервного копирования.

      Необходимо описать, какие варианты резервного копирования подходят в случаях:

      1.1. Необходимо восстанавливать данные в полном объёме за предыдущий день.

      1.2. Необходимо восстанавливать данные за час до предполагаемой поломки.

      1.3.* Возможен ли кейс, когда при поломке базы происходило моментальное переключение на работающую 
            или починенную базу данных.

      Приведите ответ в свободной форме.
----

Будем делать все средствами СУБД

1.1 - Будем использовать дифференциальную резервную копию - тк позволяет быстрее восстанавливать данные по сравнению с инкрементным резервным копированием, поскольку для этого требуется всего две части резервной копии: полная резервная копия и последняя дифференциальная резервная копия. Данное резервное копирование быстрее, чем полное, но медленнее, чем инкрементное .

1.2 - Будем использовать инкрементное резервное копирование - тк оно использует полную копию, как начальную точку, затем выполняется резервное копирование только блоков данных, которые были изменены с момента последнего резервного задания, с заданным периодом выполнения задания. В зависимости от политики хранения резервных копии, через определенный период создается новая полная копия для повторения цикла. Инкрементное резервное копирование можно выполнять так часто, как требуется, так как сохраняются только копии последних изменений.

# Задание 2. PostgreSQL

      2.1. С помощью официальной документации приведите пример команды резервирования 
            данных и восстановления БД (pgdump/pgrestore).

      2.1.* Возможно ли автоматизировать этот процесс? Если да, то как?

      Приведите ответ в свободной форме.
----
2.1 - Командой pg_dump -Fc bd_name > dump.sql    - делаем дамп базы, восстановление делаем через   pg_restore –d bd_name dump.sql

2.2 - Да возможно, для этого используем скрипт

    #!/bin/sh PATH=/etc:/bin:/sbin:/usr/bin:/usr/sbin:/usr/local/bin:/usr/local/sbin PGPASSWORD=password
       export PGPASSWORD 
        pathB=/backup
        dbUser=dbuser database=db
        find $pathB ( -name "-1[^5]." -o -name "-[023]?." ) -ctime +61 -delete
        pg_dump -U dbuser(date "+%Y-%m-%d").sql.gz
        unset PGPASSWORD
      или для запуска резервного копирования по расписанию, сохраняем скрипт в файл, 
      например, /scripts/postgresql_dump.sh и создаем задание в планировщике:
       crontab -e
       3 0 * * * /scripts/postgresql_dump.sh
       Будет старотовать каждый день в 3 утр


# Задание 3. MySQL

      3.1. С помощью официальной документации приведите пример команды инкрементного
      резервного копирования базы данных MySQL.

      3.1.* В каких случаях использование реплики будет давать преимущество по сравнению
      с обычным резервным копированием?

      Приведите ответ в свободной форме.

3.1   --incremental-base=history:last_full_backup

или

через xtrabackup  -   xtrabackup --backup --target-dir=/root/backupdb/inc1 --incremental-basedir=/root/backupdb/full 
